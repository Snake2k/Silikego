# Root
project(Xavi)
cmake_minimum_required (VERSION 2.8)

set(Xavi_VERSION_MAJOR 0)
set(Xavi_VERSION_MINOR 0)
set(Xavi_VERSION_PATCH 0)

find_package(BISON 2.4.1 REQUIRED)
find_package(FLEX 2.5.35 REQUIRED)
find_package(Qt4)

option(BUILD_XAVISTA
  "Build Xavista, a Qt-based GUI frontend to Xavi"
  ${QT4_FOUND})
option(BUILD_SHARED_LIBS "Build Xavi as a shared library." ON)
option(BUILD_TESTS "Build testing programs." OFF)

if(WIN32)
  set(MATH_LIB)
  set(RUNTIME_INSTALL_PATH .)
  set(ARCHIVE_INSTALL_PATH .)
  set(LIBRARY_INSTALL_PATH .)
  set(BUNDLE_INSTALL_PATH Error)
  set(FRAMEWORK_INSTALL_PATH Error)
  set(HEADER_INSTALL_PATH .)
elseif(APPLE)
  set(MATH_LIB)
  set(RUNTIME_INSTALL_PATH Error)
  set(ARCHIVE_INSTALL_PATH Error)
  set(LIBRARY_INSTALL_PATH Error)
  set(BUNDLE_INSTALL_PATH .)
  set(FRAMEWORK_INSTALL_PATH .)
  set(HEADER_INSTALL_PATH Error)
  #set(CPACK_BINARY_DRAGNDROP ON)
elseif(UNIX)
  set(MATH_LIB m)
  set(RUNTIME_INSTALL_PATH bin)
  set(ARCHIVE_INSTALL_PATH lib)
  set(LIBRARY_INSTALL_PATH lib)
  set(BUNDLE_INSTALL_PATH share/xavi/error)
  set(FRAMEWORK_INSTALL_PATH share/xavi/error)
  set(HEADER_INSTALL_PATH include)
endif()

add_subdirectory(Xavi)
if(BUILD_XAVISTA)
  add_subdirectory(Xavista)
endif(BUILD_XAVISTA)
if(BUILD_TESTS)
  add_subdirectory(Tests)
endif(BUILD_TESTS)

include(CPack)
